<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- ../system.conf have denied everything, so we just punch some holes -->
  <policy user="root">
    <allow own="org.bluez.frwk_agent"/>
    <allow send_destination="org.bluez.frwk_agent"/>
    <allow own="org.bluez"/>
    <allow send_destination="org.bluez"/>
  </policy>
  <!-- allow users of bt_use group (Tizen BT group) to
       communicate with bluetoothd -->
  <policy group="bt_use">
    <allow send_destination="org.bluez.frwk_agent"/>
    <allow send_destination="org.bluez"/>
  </policy>
  <!-- allow users of lp group (printing subsystem) to
       communicate with bluetoothd -->
  <policy group="lp">
    <allow send_destination="org.bluez.frwk_agent"/>
    <allow send_destination="org.bluez"/>
  </policy>
  <policy group="network_fw">
    <allow own="org.bluez.frwk_agent"/>
    <allow send_destination="org.bluez.frwk_agent"/>
    <allow own="org.bluez"/>
    <allow send_destination="org.bluez"/>
  </policy>
  <policy context="default">
    <deny own="org.bluez"/>
    <deny send_destination="org.bluez"/>
    <deny own="org.bluez.frwk_agent"/>
    <deny send_destination="org.bluez.frwk_agent"/>

    <allow send_destination="org.bluez" send_interface="org.freedesktop.DBus.Properties" send_member="Get"/>
    <allow send_destination="org.bluez" send_interface="org.freedesktop.DBus.Properties" send_member="GetAll"/>
    <allow send_destination="org.bluez" send_interface="org.freedesktop.DBus.ObjectManager" send_member="DefaultAdapter"/>
    <allow send_destination="org.bluez" send_interface="org.freedesktop.DBus.ObjectManager" send_member="GetManagedObjects"/>

    <check send_destination="org.bluez" send_interface="org.bluez.Adapter1" send_member="CreateDevice" privilege="http://tizen.org/privilege/bluetooth"/>

    <allow send_destination="org.bluez" send_interface="org.bluez.Device1" send_member="DiscoverServices"/>
    <check send_destination="org.bluez" send_interface="org.bluez.Device1" send_member="ConnectProfile" privilege="http://tizen.org/privilege/bluetooth"/>
    <check send_destination="org.bluez" send_interface="org.bluez.Device1" send_member="DisconnectProfile" privilege="http://tizen.org/privilege/bluetooth"/>
    <check send_destination="org.bluez" send_interface="org.bluez.Device1" send_member="DisconnectExtProfile" privilege="http://tizen.org/privilege/bluetooth"/>
    <check send_destination="org.bluez" send_interface="org.bluez.Device1" send_member="CancelDiscovery" privilege="http://tizen.org/privilege/bluetooth"/>

    <allow send_destination="org.bluez" send_interface="org.bluez.GattManager1" send_member="GetService"/>
    <check send_destination="org.bluez" send_interface="org.bluez.GattManager1" send_member="RegisterApplication" privilege="http://tizen.org/privilege/bluetooth"/>
    <check send_destination="org.bluez" send_interface="org.bluez.GattManager1" send_member="UnregisterApplication" privilege="http://tizen.org/privilege/bluetooth"/>

    <check send_destination="org.bluez" send_interface="org.bluez.ProfileManager1" send_member="RegisterProfile" privilege="http://tizen.org/privilege/bluetooth"/>
    <check send_destination="org.bluez" send_interface="org.bluez.ProfileManager1" send_member="RegisterProfile1" privilege="http://tizen.org/privilege/bluetooth.admin"/>
    <check send_destination="org.bluez" send_interface="org.bluez.ProfileManager1" send_member="RegisterProfile2" privilege="http://tizen.org/privilege/bluetooth.admin"/>
    <check send_destination="org.bluez" send_interface="org.bluez.ProfileManager1" send_member="UnregisterProfile" privilege="http://tizen.org/privilege/bluetooth"/>
  </policy>
</busconfig>
