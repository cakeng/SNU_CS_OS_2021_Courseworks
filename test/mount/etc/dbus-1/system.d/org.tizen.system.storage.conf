<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>
    <policy user="root">
        <allow own="org.tizen.system.storage"/>
        <allow send_destination="org.tizen.system.storage"/>
    </policy>

    <policy user="security_fw">
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetControl"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="Control"/>
    </policy>

    <policy context="default">
        <deny own="org.tizen.system.storage"/>
        <deny send_destination="org.tizen.system.storage"/>
        <allow send_destination="org.tizen.system.storage" send_type="signal"/>

        <check send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                privilege="http://tizen.org/privilege/externalstorage"/>

        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Storage"
                send_member="GetStatus"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Storage"
                send_member="getstorage"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Storage"
                send_member="GetStatvfs"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Storage"
                send_member="GetStorageLevel"/>

        <deny send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetControl"/>
        <deny send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="Control"/>

        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="ShowDeviceList"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetDeviceList"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetDeviceList2"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetDeviceInfo"/>
        <allow send_destination="org.tizen.system.storage"
                send_path="/Org/Tizen/System/Storage/Block/Manager"
                send_member="GetMmcPrimary"/>
    </policy>
</busconfig>
